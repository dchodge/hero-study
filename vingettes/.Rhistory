purrr::map_dfc(1:5, ~ posterior_ncp_titre$alpha[,.x] %>% quantile(c(0.025, 0.975)))
purrr::map_dfr(1:5, ~ posterior_ncp_titre$alpha[,.x] %>% quantile(c(0.025, 0.975)))
ggplot() +
geom_point(data = plot_df_1, aes(x = ag, y= mean)) +
geom_errorbar(width=.1, aes(ymin=`2.5%`, ymax=`97.5%`), colour="red")
purrr::map_dbl(1:5, ~ posterior_ncp_titre$alpha[,.x] %>% mean)
plot_df_1 <- purrr::map_dfr(1:5, ~ posterior_ncp_titre$alpha[,.x] %>% quantile(c(0.025, 0.975)))
plot_df_1$mean <- purrr::map_dbl(1:5, ~ posterior_ncp_titre$alpha[,.x] %>% mean)
ggplot() +
geom_point(data = plot_df_1, aes(x = ag, y= mean)) +
geom_errorbar(width=.1, aes(ymin=`2.5%`, ymax=`97.5%`), colour="red")
ggplot() +
geom_point(data = plot_df_1, aes(x = ag, y= mean)) +
geom_errorbar(data = plot_df_1, width=.1, aes(ymin=`2.5%`, ymax=`97.5%`), colour="red")
ggplot() +
geom_point(data = plot_df_1, aes(x = ag, y= mean)) +
geom_errorbar(data = plot_df_1, width=.1, aes(x = ag, ymin=`2.5%`, ymax=`97.5%`), colour="red")
ggplot() +
geom_point(data = plot_df_1, aes(x = ag, y= mean), shape=21, size=3, fill="white") +
geom_errorbar(data = plot_df_1, width=.1, aes(x = ag, ymin=`2.5%`, ymax=`97.5%`), colour="red")
ggplot() +
geom_errorbar(data = plot_df_1, width=.1, aes(x = ag, ymin=`2.5%`, ymax=`97.5%`), colour="red") +  geom_point(data = plot_df_1, aes(x = ag, y= mean), shape=21, size=3, fill="white")
ggplot() +
geom_errorbar(data = plot_df_1, width=.1, aes(x = ag, ymin=`2.5%`, ymax=`97.5%`), colour="red") +  geom_point(data = plot_df_1, aes(x = ag, y= mean), shape=21, size=3, fill="white") + labs(x = "Age Group", y = "Average decline over 100 days")
ggplot() +
geom_errorbar(data = plot_df_1, width=.1, aes(y = ag, xmin=`2.5%`, xmax=`97.5%`), colour="red") +
geom_point(data = plot_df_1, aes(y = ag, x= mean), shape=21, size=3, fill="white") + labs(x = "Age Group", y = "Average decline over 100 days")
ggplot() +
geom_errorbar(data = plot_df_1, width=.1, aes(y = ag, xmin=`2.5%`, xmax=`97.5%`), colour="red") +
geom_point(data = plot_df_1, aes(y = ag, x= mean), shape=21, size=3, fill="white") + labs(y = "Age Group", x = "Average decline over 100 days")
ggplot() +
geom_errorbar(data = plot_df_1, width=.1, aes(y = ag, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = plot_df_1, aes(y = ag, x= mean), shape=21, size=3, fill="white") + labs(y = "Age Group", x = "Average decline over 100 days")
plot_df_1
colnames(posterior_spike_unit$alpha) <- ag
colnames(posterior_spike_titre$alpha) <- ag
colnames(posterior_ncp_unit$alpha) <- ag
colnames(posterior_ncp_titre$alpha) <- ag
get_data_plot <- function(posterior, string){
plot_df_1 <- purrr::map_dfr(1:5, ~ posterior$alpha[,.x] %>% quantile(c(0.025, 0.975)))
plot_df_1$mean <- purrr::map_dbl(1:5, ~ posterior$alpha[,.x] %>% mean)
plot_df_1$measure_type <- string
}
df_plot_all <- rbind(
get_data_plot(posterior_spike_unit,  "spike_unit"),
get_data_plot(posterior_spike_titre,  "spike_titre"),
get_data_plot(posterior_ncp_unit,  "ncp_unit"),
get_data_plot(posterior_ncp_titre,  "ncp_titre"))
df_plot_all
colnames(posterior_spike_unit$alpha) <- ag
colnames(posterior_spike_titre$alpha) <- ag
colnames(posterior_ncp_unit$alpha) <- ag
colnames(posterior_ncp_titre$alpha) <- ag
get_data_plot <- function(posterior, string){
plot_df_1 <- purrr::map_dfr(1:5, ~ posterior$alpha[,.x] %>% quantile(c(0.025, 0.975)))
plot_df_1$mean <- purrr::map_dbl(1:5, ~ posterior$alpha[,.x] %>% mean)
plot_df_1$measure_type <- string
plot_df_1
}
df_plot_all <- rbind(
get_data_plot(posterior_spike_unit,  "spike_unit"),
get_data_plot(posterior_spike_titre,  "spike_titre"),
get_data_plot(posterior_ncp_unit,  "ncp_unit"),
get_data_plot(posterior_ncp_titre,  "ncp_titre"))
df_plot_all
ggplot() +
geom_errorbar(data = plot_df_1, width=.1, aes(y = ag, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = plot_df_1, aes(y = ag, x= mean), shape=21, size=3, fill="white") +
facet_grid(rows = vars(measure_type)) +
labs(y = "Age Group", x = "Average decline over 100 days")
ggplot() +
geom_errorbar(data = df_plot_all, width=.1, aes(y = ag, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = plot_df_1, aes(y = ag, x= mean), shape=21, size=3, fill="white") +
facet_grid(rows = vars(measure_type)) +
labs(y = "Age Group", x = "Average decline over 100 days")
df_plot_all
ggplot() +
geom_errorbar(data = df_plot_all, width=.1, aes(y = ag, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = ag, x= mean), shape=21, size=3, fill="white") +
facet_grid(rows = vars(measure_type)) +
labs(y = "Age Group", x = "Average decline over 100 days")
ggplot(data = df_plot_all) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = ag, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = ag, x= mean), shape=21, size=3, fill="white") +
facet_grid(rows = vars(measure_type)) +
labs(y = "Age Group", x = "Average decline over 100 days")
?facet_grid
ggplot(data = df_plot_all) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = ag, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = ag, x= mean), shape=21, size=3, fill="white")
ag
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = ag, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = ag, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average decline over 100 days")
df_plot_all
colnames(posterior_spike_unit$alpha) <- ag
colnames(posterior_spike_titre$alpha) <- ag
colnames(posterior_ncp_unit$alpha) <- ag
colnames(posterior_ncp_titre$alpha) <- ag
get_data_plot <- function(posterior, string){
plot_df_1 <- purrr::map_dfr(1:5, ~ posterior$alpha[,.x] %>% quantile(c(0.025, 0.975)))
plot_df_1$mean <- purrr::map_dbl(1:5, ~ posterior$alpha[,.x] %>% mean)
plot_df_1$measure_type <- string
plot_df_1$age <- ag
plot_df_1
}
df_plot_all <- rbind(
get_data_plot(posterior_spike_unit,  "spike_unit"),
get_data_plot(posterior_spike_titre,  "spike_titre"),
get_data_plot(posterior_ncp_unit,  "ncp_unit"),
get_data_plot(posterior_ncp_titre,  "ncp_titre"))
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = ag, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = ag, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average decline over 100 days")
df_plot_all
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average decline over 100 days")
?vline
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
geom_vline(yintercept=0) +
labs(y = "Age Group", x = "Average decline over 100 days")
?geom_vline
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
geom_vline(xintercept=0) +
labs(y = "Age Group", x = "Average decline over 100 days")
?geom_vline
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
geom_vline(xintercept=0, linetype = "dashed") +
labs(y = "Age Group", x = "Average decline over 100 days")
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
geom_vline(xintercept=0, linetype = "dashed", color = 'red') +
labs(y = "Age Group", x = "Average decline over 100 days")
View(ab_data_final)
devtools::load_all()
plot_alpha_only()
get_data_ab_model()
run_fit_ab_model()
ab_data_final <- get_data_ab_model()
ab_data_final
run_fit_ab_model()
ab_data_final <- get_data_ab_model()
ab_data_final_spike_unit <- ab_data_final %>% select(titre_1_obs=spike_unit_1, titre_2_obs=spike_unit_2, T1, T2, age_group, gender, EthGroup)
ab_data_final_spike_titre <- ab_data_final %>% select(titre_1_obs=spike_titre_1, titre_2_obs=spike_titre_2, T1, T2, age_group, gender, EthGroup)
ab_data_final_ncp_unit <- ab_data_final %>% select(titre_1_obs=ncp_unit_1, titre_2_obs=ncp_unit_2, T1, T2, age_group, gender, EthGroup)
ab_data_final_ncp_titre <- ab_data_final %>% select(titre_1_obs=ncp_titre_1, titre_2_obs=ncp_titre_2, T1, T2, age_group, gender, EthGroup)
ab_data_final_ncp_titre
model_str <- alist(
titre_2_obs ~ dnorm(titre_2_true, sigma_t2),
sigma_t2 <- exp(gamma*log(sigma*titre_2_true)),
titre_2_true <- titre_1_true  + (T2 - T1)*alpha_2[age_group],
titre_1_obs ~ dnorm(titre_1_true, sigma_t1),
sigma_t1 <- exp(gamma*log(sigma*titre_1_true)),
titre_1_true <- titre_0[age_group] + (T1)*alpha_1[age_group],
titre_0[age_group] ~ dlnorm(log(4), 0.3),
sigma ~ dexp(1),
alpha_1[age_group] ~ dnorm(0, 1),
alpha_2[age_group] ~ dnorm(0, 1),
#  inter[age_group] ~ dnorm(0, 0.5),
gamma ~ dunif(0,2))
m_spike_unit <- quap(model_str, data = ab_data_final_spike_unit)
ab_data_final_ncp_titre
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
plot_alpha_only()
list_models <- run_fit_ab_model()
posterior_list <-get_post_ab_model(list_models)
posterior_list
posterior_list[["posterior_spike_unit"]]
posterior_list[["posterior_spike_unit"]]$alpha_1
posterior_list[["posterior_spike_unit"]]$alpha
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
plot_alpha_only()
plot_all_with_data()
devtools::load_all()
plot_alpha_only()
ab_data
ab_data <- get_data_ab_model()
ab_data
ab_data$age_group$levels
ab_data$age_group
plot_alpha_only()
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
plot_alpha_only()
plot_all_with_data()
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
plot_all_with_data()
ab_data
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
plot_all_with_data()
ab_data_long
ab_data_long <- get_data_ab()
ab_data_long
devtools::load_all()
plot_alpha_only()
list_models <- run_fit_ab_model()
posterior_list <- get_post_ab_model(list_models)
posterior_list[["posterior_spike_unit"]]
str(posterior_list[["posterior_spike_unit"]])
ab_data_long <- get_data_ab()
ab_data <- get_data_ab_model()
list_models <- run_fit_ab_model()
posterior_list <-get_post_ab_model(list_models)
posterior_list
posterior_list$posterior_spike_unit
posterior_list$posterior_spike_unit$titre_0
posterior_list$posterior_spike_unit$titre_0[1,]
posterior_list$posterior_spike_unit$titre_0[,1]
posterior_list$posterior_spike_unit$titre_0[,1] + 0.5
posterior_list$posterior_spike_unit$titre_0[,1] + 0.5*posterior_list$posterior_spike_unit$alpha[,1]
posterior_list$posterior_spike_unit$alpha[,1]
map(1:5, ~posterior_list$posterior_spike_unit$titre_0[,.x] + 0.5*posterior_list$posterior_spike_unit$alpha[,.x])
purrr::map(1:5, ~posterior_list$posterior_spike_unit$titre_0[,.x] + 0.5*posterior_list$posterior_spike_unit$alpha[,.x])
lol <- purrr::map(1:5, ~posterior_list$posterior_spike_unit$titre_0[,.x] + 0.5*posterior_list$posterior_spike_unit$alpha[,.x])
lol
lol[1]
lol[1] %>% mean
lol[[1]] %>% mean
lol <- purrr::map(1:5, ~posterior_list$posterior_spike_unit$titre_0[,.x] + 0.5*posterior_list$posterior_spike_unit$alpha[,.x] %>% quantile(0.025, 0.975))
lol
lol <- purrr::map(1:5, ~ (posterior_list$posterior_spike_unit$titre_0[,.x] + 0.5*posterior_list$posterior_spike_unit$alpha[,.x] %>% quantile(0.025, 0.975)))
lol
lol <- purrr::map(1:5, posterior_list$posterior_spike_unit$titre_0[,.x] + 0.5*posterior_list$posterior_spike_unit$alpha[,.x]_
lol2 <- purrr::map(1:5, ~(lol[[.x]] %>% quantile(0.025, 0.975)))
lol <- purrr::map(1:5, posterior_list$posterior_spike_unit$titre_0[,.x] + 0.5*posterior_list$posterior_spike_unit$alpha[,.x]_
lol  lol <- purrr::map(1:5, posterior_list$posterior_spike_unit$titre_0[,.x] + 0.5*posterior_list$posterior_spike_unit$alpha[,.x])
lol <- purrr::map(1:5, posterior_list$posterior_spike_unit$titre_0[,.x] + 0.5*posterior_list$posterior_spike_unit$alpha[,.x])
lol <- purrr::map(1:5, ~posterior_list$posterior_spike_unit$titre_0[,.x] + 0.5*posterior_list$posterior_spike_unit$alpha[,.x])
lol
lol2 <- purrr::map(1:5, ~(lol[[.x]] %>% quantile(0.025, 0.975)))
lol2
lol2 <- purrr::map_dfr(1:5, ~(lol[[.x]] %>% quantile(0.025, 0.975)))
lol2
lol <- purrr::map(1:5, ~posterior_list$posterior_spike_unit$titre_0[,.x] + 0.5*posterior_list$posterior_spike_unit$alpha[,.x])
lol2 <- purrr::map_dfr(1:5, ~(lol[[.x]] %>% quantile(c(0.025, 0.975))))
lol2
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
get_avg_titre()
get_avg_titre()
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
get_avg_titre()
get_avg_titre <- function(){
ab_data_long <- get_data_ab()
ab_data <- get_data_ab_model()
list_models <- run_fit_ab_model()
posterior_list <- get_post_ab_model(list_models)
get_data_plot <- function(posterior, string){
temp <- purrr::map(1:5, ~posterior$titre_0[,.x] + 0.5*posterior$alpha[,.x])
temp2 <- purrr::map_dfr(1:5, ~(temp[[.x]] %>% quantile(c(0.025, 0.975))))
temp2$mean <- purrr::map_dbl(1:5, ~ temp %>% mean)
temp2 <- string
temp2$age <- ag
temp2
}
df_plot_all <- rbind(
get_data_plot(posterior_list[["posterior_spike_unit"]],  "spike_unit"),
get_data_plot(posterior_list[["posterior_spike_titre"]],  "spike_titre"),
get_data_plot(posterior_list[["posterior_ncp_unit"]],  "ncp_unit"),
get_data_plot(posterior_list[["posterior_ncp_titre"]],  "ncp_titre"))
df_plot_all
}
get_avg_titre()
posterior_list[["posterior_spike_unit"]]
posterior_list[["posterior_spike_unit"]]$titre_0
posterior_list[["posterior_spike_unit"]]$titre_0[,1]
posterior_list[["posterior_spike_unit"]]$alphha[,1]
posterior_list[["posterior_spike_unit"]]$alpha[,1]
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
get_avg_titre()
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
get_avg_titre()
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
get_avg_titre()
get_avg_titre <- function(){
ab_data_long <- get_data_ab()
ab_data <- get_data_ab_model()
list_models <- run_fit_ab_model()
posterior_list <- get_post_ab_model(list_models)
get_data_plot <- function(posterior, string){
temp <- purrr::map(1:5, ~posterior$titre_0[,.x] + 0.5*posterior$alpha[,.x])
temp2 <- purrr::map_dfr(1:5, ~(temp[[.x]] %>% quantile(c(0.025, 0.975))))
temp2$mean <- purrr::map_dbl(1:5, ~ temp[[.x]] %>% mean)
temp2$measure_type <- string
temp2$age <- ag
temp2
}
df_plot_all <- rbind(
get_data_plot(posterior_list[["posterior_spike_unit"]],  "spike_unit"),
get_data_plot(posterior_list[["posterior_spike_titre"]],  "spike_titre"),
get_data_plot(posterior_list[["posterior_ncp_unit"]],  "ncp_unit"),
get_data_plot(posterior_list[["posterior_ncp_titre"]],  "ncp_titre"))
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
}
get_avg_titre()
ab_data_long
ggplot() + geom_point(data = ab_data_long, aes(x = spike_unit, y = age_group))
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = spike_unit, y = age_group))
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
get_avg_titre()
get_avg_titre()
source('~/Dropbox/My Mac (David’s MacBook Air)/Documents/research/covid/HERO/serobayes/R/ab_kinetics.R', echo=TRUE)
get_avg_titre()
ab_data_long <- get_data_ab()
ab_data <- get_data_ab_model()
list_models <- run_fit_ab_model()
posterior_list <- get_post_ab_model(list_models)
get_data_plot <- function(posterior, string){
temp <- purrr::map(1:5, ~posterior$titre_0[,.x] + 0.5*posterior$alpha[,.x])
temp2 <- purrr::map_dfr(1:5, ~(temp[[.x]] %>% quantile(c(0.025, 0.975))))
temp2$mean <- purrr::map_dbl(1:5, ~ temp[[.x]] %>% mean)
temp2$measure_type <- string
temp2$age <- ag
temp2
}
df_plot_all <- rbind(
get_data_plot(posterior_list[["posterior_spike_unit"]],  "spike_unit"),
get_data_plot(posterior_list[["posterior_spike_titre"]],  "spike_titre"),
get_data_plot(posterior_list[["posterior_ncp_unit"]],  "ncp_unit"),
get_data_plot(posterior_list[["posterior_ncp_titre"]],  "ncp_titre"))
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = spike_unit, y = as.character(age_group))) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
ab_data_long
ab_data
ab_data_long
ab_data_long
v
factor(ab_data_long$age_group, levels = ag, labels = ag)
factor(ab_data_long$age_group, levels = 1:5, labels = ag)
ab_data_long$age_group
ab_data_long
ab_data_long %>% select(age_group, spike_unit, spike, titre, ncp_unit,  ncp_titre) %>%
melt(id.vars=age_group)
ab_data_long %>% select(age_group, spike_unit, spike_titre, ncp_unit,  ncp_titre) %>%
melt(id.vars=age_group)
ab_data_long %>% select(age_group, spike_unit, spike_titre, ncp_unit,  ncp_titre) %>%
melt(id.vars="age_group")
ab_data_long$age_group <- factor(ab_data_long$age_group, levels = 1:5, labels = ag)
ab_data_long %>% select(age_group, spike_unit, spike_titre, ncp_unit,  ncp_titre) %>%
melt(id.vars="age_group")
ab_data_long$age_group <- factor(ab_data_long$age_group, levels = 1:5, labels = ag)
ab_data_long <- ab_data_long %>% select(age_group, spike_unit, spike_titre, ncp_unit,  ncp_titre) %>%
melt(id.vars="age_group", variable.names = "measure_type")
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = value, y = age_group)) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
ab_data_long
df_plot_all <- rbind(
get_data_plot(posterior_list[["posterior_spike_unit"]],  "spike_unit"),
get_data_plot(posterior_list[["posterior_spike_titre"]],  "spike_titre"),
get_data_plot(posterior_list[["posterior_ncp_unit"]],  "ncp_unit"),
get_data_plot(posterior_list[["posterior_ncp_titre"]],  "ncp_titre"))
ab_data_long$age_group <- factor(ab_data_long$age_group, levels = 1:5, labels = ag)
ab_data_long <- ab_data_long %>% select(age_group, spike_unit, spike_titre, ncp_unit,  ncp_titre) %>%
melt(id.vars="age_group", variable.names = "measure_type")
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = value, y = age_group)) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
ab_data_long
df_plot_all <- rbind(
get_data_plot(posterior_list[["posterior_spike_unit"]],  "spike_unit"),
get_data_plot(posterior_list[["posterior_spike_titre"]],  "spike_titre"),
get_data_plot(posterior_list[["posterior_ncp_unit"]],  "ncp_unit"),
get_data_plot(posterior_list[["posterior_ncp_titre"]],  "ncp_titre"))
ab_data_long$age_group <- factor(ab_data_long$age_group, levels = 1:5, labels = ag)
> ab_data_long$age_group <- factor(ab_data_long$age_group, levels = 1:5, labels = ag)
ab_data_long
df_plot_all <- rbind(
get_data_plot(posterior_list[["posterior_spike_unit"]],  "spike_unit"),
get_data_plot(posterior_list[["posterior_spike_titre"]],  "spike_titre"),
get_data_plot(posterior_list[["posterior_ncp_unit"]],  "ncp_unit"),
get_data_plot(posterior_list[["posterior_ncp_titre"]],  "ncp_titre"))
df_plot_all
ab_data_long <- get_data_ab()
ab_data_long$age_group <- factor(ab_data_long$age_group, levels = 1:5, labels = ag)
ab_data_long <- ab_data_long %>% select(age_group, spike_unit, spike_titre, ncp_unit,  ncp_titre) %>%
melt(id.vars="age_group", variable.names = "measure_type")
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = value, y = age_group)) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
ab_data_long
ab_data_long$age_group <- factor(ab_data_long$age_group, levels = 1:5, labels = ag)
ab_data_long <- ab_data_long %>% select(age_group, spike_unit, spike_titre, ncp_unit,  ncp_titre) %>%
melt(id.vars="age_group", variable.name = "measure_type")
ab_data_long <- get_data_ab()
ab_data_long$age_group <- factor(ab_data_long$age_group, levels = 1:5, labels = ag)
ab_data_long <- ab_data_long %>% select(age_group, spike_unit, spike_titre, ncp_unit,  ncp_titre) %>%
melt(id.vars="age_group", variable.names = "measure_type")
ab_data_long
ab_data_long <- get_data_ab()
ab_data_long$age_group <- factor(ab_data_long$age_group, levels = 1:5, labels = ag)
ab_data_long <- ab_data_long %>% select(age_group, spike_unit, spike_titre, ncp_unit,  ncp_titre) %>%
melt(id.vars="age_group", vars.name = "measure_type")
ab_data_long
ab_data_long <- get_data_ab()
ab_data_long$age_group <- factor(ab_data_long$age_group, levels = 1:5, labels = ag)
ab_data_long <- ab_data_long %>% select(age_group, spike_unit, spike_titre, ncp_unit,  ncp_titre) %>%
melt(id.vars="age_group", variable.name = "measure_type")
ab_data_long
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = value, y = age_group)) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = value, y = age_group), alpha = 0.2, size=0.01) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = value, y = age_group), alpha = 0.2, size=0.05) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = value, y = age_group), alpha = 0.2, size=0.1) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = value, y = age_group), alpha = 0.2, size=1) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="black") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = value, y = age_group), alpha = 0.3, size=1) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="red") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
?geom_errorbar
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = value, y = age_group), alpha = 0.3, size=1) +
geom_pointrange(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="red") +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = value, y = age_group), alpha = 0.3, size=1) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="red", width=0.5) +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = value, y = age_group), alpha = 0.3, size=1) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="red", size=0.5) +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
ggplot(data = df_plot_all) +
facet_grid(rows = vars(measure_type)) +
geom_point(data = ab_data_long, aes(x = value, y = age_group), alpha = 0.3, size=1) +
geom_errorbar(data = df_plot_all, width=.1, aes(y = age, xmin=`2.5%`, xmax=`97.5%`), colour="red", size=1) +
geom_point(data = df_plot_all, aes(y = age, x= mean), shape=21, size=3, fill="white") +
labs(y = "Age Group", x = "Average titre")
devtools::load_all()
plot_alpha_only()]
plot_alpha_only()
plot_all_with_data()
lol <- plot_alpha_only()
lol2 <- get_avg_titre
lol2 <- get_avg_titre()
lol
lol2
ggarrange(lol, lol2, nrow=2)
ggarrange(lol2, lol, nrow=2)
